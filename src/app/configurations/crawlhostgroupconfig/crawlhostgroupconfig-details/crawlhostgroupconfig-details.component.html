<h2 *ngIf="crawlhostgroupconfig.id">Crawlhostgroupconfig Details</h2>
<h2 *ngIf="!crawlhostgroupconfig.id">New Crawlhostgroupconfig</h2>


<form [formGroup]="crawlhostgroupconfigForm" fxLayout="column">

  <md-form-field formGroupName="meta">
    <input mdInput formControlName="name" placeholder="Navn">
    <md-error *ngIf="! crawlhostgroupconfigForm.controls.meta.valid">
      Navn er påkrevd.
    </md-error>
  </md-form-field>

  <md-form-field formGroupName="meta">
    <input mdInput formControlName="description" placeholder="Beskrivelse">
  </md-form-field>

  <md-expansion-panel formArrayName="ip_range">
    <md-expansion-panel-header>
      <md-panel-title>
        IP-range
      </md-panel-title>
      <md-panel-description>
        IP-range som skal benyttes
      </md-panel-description>
    </md-expansion-panel-header>
    <md-card *ngFor="let ip_range of ip_range.controls; let i=index" [formGroupName]="i">
      <md-card-header>
        <md-card-title>IP-range #{{i + 1}}</md-card-title>
      </md-card-header>
      <md-card-content>
        <md-form-field>
          <input mdInput formControlName="ip_from" placeholder="Fra IP-addresse:">
          <md-error *ngIf="! crawlhostgroupconfigForm.controls['ip_range'].controls[i].controls.ip_from.valid">
            En gyldig IP-addresse er påkrevd.
          </md-error>
        </md-form-field>
        <md-form-field>
          <input mdInput formControlName="ip_to" placeholder="Til IP-addresse">
          <md-error *ngIf="! crawlhostgroupconfigForm.controls.ip_range.controls[i].controls.ip_to.valid">
            En gyldig IP-addresse er påkrevd.
          </md-error>
        </md-form-field>
        <button md-icon-button (click)="removeIpRange(i)">
          <md-icon>close</md-icon>
        </button>
      </md-card-content>
    </md-card>
    <button md-raised-button color="accent" (click)="addIpRange()">Legg til IP-range</button>
  </md-expansion-panel>

  <md-expansion-panel formArrayName="label">
    <md-expansion-panel-header>
      <md-panel-title>
        Merkelapp
      </md-panel-title>
      <md-panel-description>
        Merkelapp beskrivelse
      </md-panel-description>
    </md-expansion-panel-header>
    <md-card *ngFor="let label of label.controls; let i=index" [formGroupName]="i">
      <md-card-header>
        <md-card-title>Merkelapp #{{i + 1}}</md-card-title>
      </md-card-header>
      <md-card-content>
        <md-form-field>
          <input mdInput formControlName="key" placeholder="Type">
        </md-form-field>
        <md-form-field>
          <input mdInput formControlName="value" placeholder="Verdi">
        </md-form-field>
        <button md-icon-button (click)="removeLabel(i)">
          <md-icon>close</md-icon>
        </button>
      </md-card-content>
    </md-card>
    <button md-raised-button color="accent" (click)="addLabel()">Legg til merkelapp</button>
  </md-expansion-panel>

  <div>
    <button md-raised-button color="primary"
            [disabled]="!crawlhostgroupconfigForm.valid"
            *ngIf="!crawlhostgroupconfig.id"
            (click)="createCrawlhostgroupconfig(crawlhostgroupconfigForm.value)" novalidate>
      Lagre
    </button>
    <button md-raised-button color="primary"
            *ngIf="crawlhostgroupconfig.id"
            [disabled]="!crawlhostgroupconfigForm.valid"
            (click)="updateCrawlhostgroupconfig(crawlhostgroupconfigForm.value)">
      Lagre
    </button>
    <button md-raised-button color="accent"
            (click)="revert()">Tilbakestill
    </button>

    <button md-raised-button color="warn"
            *ngIf="crawlhostgroupconfig.id"
            (click)="deleteCrawlhostgroupconfig(crawlhostgroupconfig.id); $event.stopPropagation()">Slett
    </button>
  </div>
</form>
