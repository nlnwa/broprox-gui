<div class="container mat-typography" fxLayout="column" *ngIf="!error; else initFailed">
  <mat-toolbar color="primary">
    <button mat-icon-button
            [mat-menu-trigger-for]="menu"
            *ngIf="isLoggedIn"
            class="header--button__margin">
      <mat-icon>menu</mat-icon>
    </button>
    <mat-menu #menu="matMenu">
      <a mat-menu-item
         *ngIf="canConfigure"
         [routerLink]="['/config']">
        <mat-icon>settings</mat-icon>&nbsp;
        <span i18n="@@navigationSidebarRolemapping">Konfigurasjon</span>
      </a>

      <a mat-menu-item
         *ngIf="canAdministrate"
         [routerLink]="['/validator']">
        <mat-icon>storage</mat-icon>&nbsp;
        <span i18n="@@navigationSidebarRolemapping">WARC</span>
      </a>

      <a mat-menu-item
         [routerLink]="['/config/logconfig']">
        <mat-icon>notes</mat-icon>&nbsp;
        <span i18n="@@navigationSidebarLogconfig">Loggnivå</span>
      </a>
    </mat-menu>

    <a routerLink="/" class="title"><h1>Veidemann {{ version }}</h1></a>

    <span fxFlex></span>

    <app-time></app-time>

    <span fxFlex></span>

    <a mat-button
       mat-icon-button
       title="Hjelp"
       target="_blank"
       [routerLink]="['/docs']"
       [routerLinkActiveOptions]="{exact: true}"
       [routerLinkActive]="['is-active']">
      <mat-icon>help</mat-icon>
    </a>

    <button color="primary"
            mat-button
            mat-flat-button
            (click)="onLogin()"
            *ngIf="!isLoggedIn">
      <mat-icon>account_box</mat-icon>&nbsp;
      <span i18n="@@toolbarLogon">LOGG PÅ</span>
    </button>

    <button color="primary"
            mat-button
            mat-flat-button
            matTooltip="{{name}}"
            (click)="onLogout()"
            *ngIf="isLoggedIn">
      <mat-icon>account_box</mat-icon>&nbsp;
      <span i18n="@@toolbarLogon">LOGG AV</span>
    </button>
  </mat-toolbar>

  <div *ngIf="isModuleLoading$ | async" class="module-loader">
    <h2>Laster modul...</h2>
    <mat-spinner [strokeWidth]="2"></mat-spinner>
  </div>

  <app-dialog></app-dialog>
  <main fxFlex>
    <router-outlet></router-outlet>
  </main>
</div>

<ng-template #initFailed>
  <div class="mat-typography" fxFlexFill fxLayout="column" fxLayoutAlign="center center" *ngIf="error">
    <h1>Initialisering feilet</h1>
    <p>{{ error.message }}</p>
  </div>
</ng-template>
